<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>Lines Police - CAD</title>
  <meta name="description" content="Lines Roleplay Police CAD. Built to facilitate the needs of roleplay police and civilians." />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="generator" content="Codeply">
  <link rel="stylesheet" href="./css/bootstrap.min.css" />
  <link rel="stylesheet" href="./css/animate.min.css" />
  <link rel="stylesheet" href="./css/ionicons.min.css" />
  <link rel="stylesheet" href="./css/styles.css" />
  <link rel="icon" href="data:;base64,iVBORw0KGgo=">
</head>

<body>
  <nav id="topNav" class="navbar navbar-default navbar-fixed-top">
    <div class="container-fluid">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
        <a class="navbar-brand page-scroll" href="/"><i class="ion-ios-analytics-outline"></i> Lines Police Server</a>
      </div>
      <div class="navbar-collapse collapse" id="bs-navbar">
        <ul class="nav navbar-nav">

        </ul>
        <ul class="nav navbar-nav navbar-right">
            <li>
                <a> Hi, <%= user.user.username %></a>
            </li>
            <li>
                <a href="/logout">Logout</a>
            </li>
        </ul>

      </div>
    </div>
  </nav>
  <header id="first" style='background-image: url("/images/dark-background.jpg");'>
    <div class="header-content">
      <div class="inner">
        <h4>San Andreas - Police Operations</h4>
        <div class="col-lg-10 col-lg-offset-1 text-center">
          <button data-toggle="modal" href="#nameDatabaseModal"  class="btn btn-primary btn-lg margin-top-2">Name Database</button>
          <button data-toggle="modal" href="#plateDatabaseModal"  class="btn btn-primary btn-lg margin-top-2">Plate Database</button>
          <button data-toggle="modal" href="#ticketModal"  class="btn btn-primary btn-lg margin-top-2" onclick="setDateAndTime();">Issue Ticket</button>
        </div>
      </div>
      <hr style="width: 88%;max-width: 100rem;">
    </div>
  </header>

  <footer id="footer">
    <div class="container-fluid">

      <span class="pull-right text-muted small"><a href="#">Lines Police Server</a> Â©2017 Merrill Lines</span>
    </div>
  </footer>
  <div id="galleryModal" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-body">
          <img src="" id="galleryImage" class="img-responsive" />
          <p>
            <br/>
            <button class="btn btn-primary btn-lg center-block" data-dismiss="modal" aria-hidden="true">Close <i class="ion-android-close"></i></button>
          </p>
        </div>
      </div>
    </div>
  </div>

  <div id="nameDatabaseModal" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
      <div id="warrantMessage" class="alert alert-danger" style="display:none">
        <strong>Danger!</strong> Warrant found for this suspect.
      </div>
      <div id="noWarrantFound" class="alert alert-success" style="display:none">
        <strong>Clean!</strong> No Warrants found.
      </div>
      <div class="modal-content">
        <div class="modal-body">
          <form class="form-horizontal" action="" method="">
            <fieldset>

            <!-- Form Name -->
            <button class="btn btn-primary btn-md float-right" data-dismiss="modal" aria-hidden="true">X</button>
            <h4>Person Database</h4>
            <hr style="width: 88%;max-width: 100rem;">
            <datalist id="names">
              <% for(var i=0; i<civilians.length; i++) {%>
           <option value="<%= civilians[i].civilian.firstName %> <%= civilians[i].civilian.lastName%>">
          <% } %>
            </datalist>

            <!-- Text input-->
            <div class="form-group">
              <label class="col-md-4" for="civ-first-name">Civilian Name</label>
              <div class="col-md-4">
              <input id="civName" name="civName" type="text" placeholder="Civilian Name" class="form-control input-md" list="names" required>
              </div>
              <div class="col-md-4">
                <button type="button" name="searchCiv" class="btn btn-info" onclick="searchNames()" >Search</button>
              </div>
            </div>

            <div id="civDetails" style="display:none">
            <div class="col-md-9">
              <label id="first-and-last-name" class="col-md-5 font-large"><strong>Name here</strong></label>
            </div>

            <div class="col-md-12">
              <div class="col-md-5">
                <label class="col-md-3 margin-bottom-1" for="dob">DOB:</label>
                <label id="birthday" class="col-md-5">dob here</label>
              </div>
              <div class="col-md-5">
                <label class="col-md-4 margin-bottom-1" for="license">License:</label>
                <label id="license-status" class="col-md-3">license here</label>
              </div>
            </div>

            <div class="col-md-12">
              <div class="col-md-5">
                <label class="col-md-4 margin-bottom-1" for="address">Address:</label>
                <label id="address" class="col-md-5">N/A</label>
              </div>
              <div class="col-md-5">
                <label class="col-md-7 margin-bottom-1" for="ticket">Ticket Count:</label>
                <label id="ticket-count" class="col-md-5">ticket here</label>
              </div>
            </div>


              <div class="col-md-9">
                <input type="button" value="NCIC Warrant Check" id="warrants" name="ncicWarrantCheck" class="btn btn-info margin-bottom-1" onclick="checkWarrantStatus()">
              </div>

            <!--Table for Tickets  -->
            <div class="col-md-5 name-table text-align-center">
              <table id="ticket-table" class="table table-hover" border="1" frame="box">
                <thead>
                  <tr>
                    Tickets:
                  </tr>
                </thead>
                  <tbody id="ticket-body">
                  </tbody>
              </table>
            </div>
          </div>
            </fieldset>
          </form>
        </div>
      </div>
    </div>
  </div>

  <div id="plateDatabaseModal" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
      <div id="stolenMessage" class="alert alert-danger" style="display:none">
        <strong>Danger!</strong> Vehicle reported as stolen.
      </div>
      <div class="modal-content">
        <div class="modal-body">
          <form class="form-horizontal" action="" method="">
            <fieldset>

            <!-- Form Name -->
            <button class="btn btn-primary btn-md float-right" data-dismiss="modal" aria-hidden="true">X</button>
            <h4>Vehicle Database</h4>
            <hr style="width: 88%;max-width: 100rem;">
            <datalist id="plates">
              <% for(var i=0; i<vehicles.length; i++) {%>
           <option value="<%= vehicles[i].vehicle.plate %>">
          <% } %>
            </datalist>

            <!-- Text input-->
            <div class="form-group">
              <label class="col-md-4" for="civ-first-name">Plate Number</label>
              <div class="col-md-4">
                <input id="plateName" name="plateName" type="text" placeholder="License Plate #" class="form-control input-md" list="plates" required>
              </div>
              <div class="col-md-4">
                <button type="button" name="searchPlateNum" class="btn btn-info" onclick="searchPlate()" >Search</button>
              </div>
            </div>

            <div id="plateDetails" style="display:none">
            <div class="col-md-9">
              <label id="plate" class="col-md-5 font-large">license plate #</label>
            </div>

              <div class="col-md-9">
                <label class="col-md-3 margin-bottom-1" for="color">Color:</label>
                <label id="color" class="col-md-5">color here</label>
              </div>

              <div class="col-md-9">
                <label class="col-md-3 margin-bottom-1" for="address">Model:</label>
                <label id="model" class="col-md-9">model here</label>
              </div>

              <div class="col-md-9">
                <label class="col-md-3 margin-bottom-1" for="ro">RO:</label>
                <label id="reg-owner" class="col-md-9">ro here</label>
              </div>

            <div class="col-md-9">
                <label class="col-md-3 margin-bottom-1" for="insurance">Insurance:</label>
                <label id="insurance" class="col-md-5">insurance</label>
              </div>

              <div class="col-md-9">
                <label class="col-md-3 margin-bottom-1" for="registration">Registration:</label>
                <label id="registration" class="col-md-5">registration</label>
              </div>
            </div>
          </div>
            </fieldset>
          </form>
        </div>
      </div>
    </div>



    <div id="ticketModal" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-body">
            <form class="form-horizontal" action="/create-ticket" method="POST">
              <fieldset>

              <button class="btn btn-primary btn-md float-right" data-dismiss="modal" aria-hidden="true">X</button>
              <h4>San Andreas Traffic Ticket</h4>
              <hr style="width: 88%;max-width: 100rem;">

              <div class="form-group">
                <label class="col-md-4 control-label" for="plate">Date of Violation</label>
                <div class="col-md-4">
                  <input id="date" name="date" type="text" placeholder="mm/dd/yyyy" class="form-control input-md" required="">
                </div>
              </div>

              <div class="form-group">
                <label class="col-md-4 control-label" for="time">Time</label>
                <div class="col-md-4">
                  <input id="time" name="time" type="text" placeholder="hh:mm" class="form-control input-md" required="">
                </div>
              </div>

              <div class="form-group">
                <label class="col-md-4 control-label" for="civName">Name</label>
                <div class="col-md-4">
                  <input id="civName" name="civName" type="text" placeholder="name" class="form-control input-md" list="names" required="">
                </div>
              </div>

              <div class="form-group">
                <label class="col-md-4 control-label" for="plate">Plate</label>
                <div class="col-md-4">
                  <input id="plate" name="plate" type="text" placeholder="plate" class="form-control input-md" list="plates">
                </div>
              </div>

              <datalist id="models">
                <% for(var i=0; i<vehicles.length; i++) {%>
                <option value="<%= vehicles[i].vehicle.model %>">
                <% } %>
              </datalist>

              <div class="form-group">
                <label class="col-md-4 control-label" for="model">Model</label>
                <div class="col-md-4">
                  <input id="model" name="model" type="text" placeholder="model" class="form-control input-md" list="models">
                </div>
              </div>

              <datalist id="colors">
                <% for(var i=0; i<vehicles.length; i++) {%>
                <option value="<%= vehicles[i].vehicle.color %>">
                <% } %>
              </datalist>

              <div class="form-group">
                <label class="col-md-4 control-label" for="color">Color</label>
                <div class="col-md-4">
                  <input id="color" name="color" type="text" placeholder="color" class="form-control input-md" list="colors">
                </div>
              </div>

              <div class="form-group">
                <label class="col-md-4 control-label" for="registeredOwner">Registered Owner</label>
                <div class="col-md-4">
                  <input id="registeredOwner" name="registeredOwner" type="text" placeholder="registeredOwner" class="form-control input-md" list="names">
                </div>
              </div>

              <!-- Multiple Checkboxes (inline) -->
              <div class="form-group">
                <label class="col-md-4 control-label" for="violations">Violations</label>
                <div class="col-md-4">
                  <label class="checkbox-inline" for="violations-0">
                    <input type="checkbox" name="violations" id="violations-0" value="Speed" onclick="toggle_visibility(speedViolationGroup);">Speed
                  </label>
                  <label class="checkbox-inline" for="violations-1">
                    <input type="checkbox" name="violations" id="violations-1" value="DUI" onclick="toggle_visibility(duiViolationGroup);">DUI
                  </label>
                  <label class="checkbox-inline" for="violations-2">
                    <input type="checkbox" name="violations" id="violations-2" value="Driver license" onclick="toggle_visibility(driverLicenseViolationGroup);">Driver License
                  </label>
                  <label class="checkbox-inline" for="violations-3">
                    <input type="checkbox" name="violations" id="violations-3" value="Invalid registration">No Valid Registration
                  </label>
                  <label class="checkbox-inline" for="violations-4">
                    <input type="checkbox" name="violations" id="violations-4" value="Invalid insurance">No Proof Insurance
                  </label>
                  <label class="checkbox-inline" for="violations-5">
                    <input type="checkbox" name="violations" id="violations-5" value="Violated traffic signal">Violated Traffic Signal
                  </label>
                  <label class="checkbox-inline" for="violations-6">
                    <input type="checkbox" name="violations" id="violations-6" value="Failure to yield">Failure to Yield
                  </label>
                  <label class="checkbox-inline" for="violations-7">
                    <input type="checkbox" name="violations" id="violations-7" value="Other" onclick="toggle_visibility(otherOffenseGroup);">Other
                  </label>
                </div>
              </div>

              <!-- Speed Violation -->
              <div id="speedViolationGroup" class="form-group" style="display:none">
                <label class="col-md-4 control-label" for="speedViolation">Speed Violation</label>
                <div class="col-md-4">
                <div class="checkbox">
                  <label for="speedViolation-0">
                    <input type="checkbox" name="speedViolation" id="speedViolation-0" value="Over limit">
                    Over limit
                  </label>
              	</div>
                <div class="checkbox">
                  <label for="speedViolation-1">
                    <input type="checkbox" name="speedViolation" id="speedViolation-1" value="Unsafe for conditions">
                    Unsafe for conditions
                  </label>
              	</div>
                </div>
              </div>

              <!-- DUI Violation -->
              <div id="duiViolationGroup" class="form-group" style="display:none">
                <label class="col-md-4 control-label" for="duiViolation">DUI Violation</label>
                <div class="col-md-4">
                <div class="checkbox">
                  <label for="duiViolation-0">
                    <input type="checkbox" name="duiViolation" id="duiViolation-0" value="Under the influence">
                    Under the influence
                  </label>
              	</div>
                <div class="checkbox">
                  <label for="duiViolation-1">
                    <input type="checkbox" name="duiViolation" id="duiViolation-1" value="Prohibited B.A.C">
                    Prohibited B.A.C
                  </label>
              	</div>
                </div>
              </div>

              <!-- Driver License Violation -->
              <div id="driverLicenseViolationGroup" class="form-group" style="display:none">
                <label class="col-md-4 control-label" for="driverLicenseViolation">Driver License Violation</label>
                <div class="col-md-4">
                <div class="checkbox">
                  <label for="driverLicenseViolation-0">
                    <input type="checkbox" name="driverLicenseViolation" id="driverLicenseViolation-0" value="No license">
                    None
                  </label>
              	</div>
                <div class="checkbox">
                  <label for="driverLicenseViolation-1">
                    <input type="checkbox" name="driverLicenseViolation" id="driverLicenseViolation-1" value="Not on person">
                    Not on person
                  </label>
              	</div>
                <div class="checkbox">
                  <label for="driverLicenseViolation-2">
                    <input type="checkbox" name="driverLicenseViolation" id="driverLicenseViolation-2" value="Revoked">
                    Revoked
                  </label>
              	</div>
                </div>
              </div>

              <!-- Other Offense-->
              <div id="otherOffenseGroup" class="form-group" style="display:none">
                <label class="col-md-4 control-label" for="otherInput">Other Offense</label>
                <div class="col-md-4">
                  <input id="otherInput" name="otherInput" type="text" placeholder="offense" class="form-control input-md">
                </div>
              </div>

              <!-- Text input-->
              <div class="form-group">
                <label class="col-md-4 control-label" for="amount">Fine Amount</label>
                <div class="col-md-4">
                  <input id="amount" name="amount" type="text" placeholder="$ amount" class="form-control input-md" required="">
                </div>
              </div>

              <!-- Button -->
              <div class="form-group">
                <label class="col-md-4 control-label" for="submitTicket"></label>
                <div class="col-md-4">
                  <button id="submitTicket" name="officerEmail" class="btn btn-primary" value=<%= user.user.email%>>Submit</button>
                </div>
              </div>
              </fieldset>
              </form>
          </div>
        </div>
      </div>
    </div>

  <!--scripts loaded here -->
  <script src="./js/jquery.min.js"></script>
  <script src="./js/bootstrap.min.js"></script>
  <script src="./js/jquery.easing.min.js"></script>
  <script src="./js/wow.js"></script>
  <script src="./js/scripts.js"></script>
</body>

</html>

<script type="text/javascript">

function searchPlate() {
  var stolenVehicle = document.getElementById('stolenMessage');
  stolenVehicle.style.display = 'none';
  var x = document.getElementById('plateDetails');
  if (x.style.display === 'none') {
      x.style.display = 'block';
  } else {
  }

  var myValue = $('#plateName').val();
  var myVar = <%- JSON.stringify(vehicles) %>;
  var index = 0;
  for (i=0; i < myVar.length; i++) {
    if (myVar[i].vehicle.plate === myValue) {
      index = i;
      break;
    }
  }
  var color = myVar[index].vehicle.color
  var plate = myVar[index].vehicle.plate
  var model = myVar[index].vehicle.model
  var registeredOwner = myVar[index].vehicle.registeredOwner
  var validInsurance = myVar[index].vehicle.validInsurance
  if (validInsurance === "1") {
    validInsurance = "Valid"
  } else {
    validInsurance = "Not Valid"
  }
  var validRegistration = myVar[index].vehicle.validRegistration
  if (validRegistration === "1") {
    validRegistration = "Valid"
  } else {
    validRegistration = "Not Valid"
  }
  var isStolen = myVar[index].vehicle.isStolen
  if (isStolen === "2") {
    stolenVehicle.style.display = 'block';
  }

  $('#color').text(color)
  $('#plate').text(plate)
  $('#model').text(model)
  $('#reg-owner').text(registeredOwner)
  $('#insurance').text(validInsurance)
  $('#registration').text(validRegistration)

}

  function searchNames(){
    var cleanWarrant = document.getElementById('noWarrantFound');
    var dirtyWarrant = document.getElementById('warrantMessage');
    cleanWarrant.style.display = 'none';
    dirtyWarrant.style.display = 'none';
    var x = document.getElementById('civDetails');
    if (x.style.display === 'none') {
        x.style.display = 'block';
    } else {
    }
    var myValue = $('#civName').val();
    var civName = myValue.split(' ')
    var myCiv = <%- JSON.stringify(civilians) %>;
    var myTicket = <%- JSON.stringify(tickets) %>;
    var index = 0;
    for (i=0; i < myCiv.length; i++) {
      if ((myCiv[i].civilian.firstName === civName[0]) && (myCiv[i].civilian.lastName === civName[1])) {
        index = i;
        break;
      }
    }
    ticketIndex = new Array();

    $("#ticket-table tr").remove();
    var table = document.getElementById("ticket-table");

    for (i=0; i < myTicket.length; i++) {
      if (myTicket[i].ticket.civName === myValue) {
        ticketIndex.push(i);

        var row = table.insertRow(0);
        var cell1 = row.insertCell(0);
        cell1.innerHTML = myTicket[i].ticket.violation;
      }
    }

    var name = myCiv[index].civilian.firstName + ' ' + myCiv[index].civilian.lastName
    var birthday = myCiv[index].civilian.birthday
    var address = myCiv[index].civilian.address
    var licenseStatus = myCiv[index].civilian.licenseStatus
    switch(licenseStatus) {
      case "1":
        licenseStatus = "Valid"
        break
      case "2":
        licenseStatus = "Revoked"
        break
      default:
        licenseStatus = "None"
    }

    var warrants = myCiv[index].civilian.warrants
    if (warrants === "1") {
      warrants = "No"
    } else {
      warrants = "Yes"
    }

    var ticketCount = ticketIndex.length
    $('#first-and-last-name').text(name)
    $('#birthday').text(birthday)
    $('#address').text(address)
    $('#license-status').text(licenseStatus)
    $('#ticket-count').text(ticketCount)

  }

  function checkWarrantStatus() {
  var dirtyWarrant = document.getElementById('warrantMessage');
  var cleanWarrant = document.getElementById('noWarrantFound');
  var myValue = $('#civName').val();
  var civName = myValue.split(' ')
  var myVar = <%- JSON.stringify(civilians) %>;
  var index = 0;
  for (i=0; i < myVar.length; i++) {
    if ((myVar[i].civilian.firstName === civName[0]) && (myVar[i].civilian.lastName === civName[1])) {
      index = i;
      break;
    }
  }

  var warrants = myVar[index].civilian.warrants
  if (warrants === "1") {
    cleanWarrant.style.display = 'block';
    dirtyWarrant.style.display = 'none';
  } else {
    dirtyWarrant.style.display = 'block';
    cleanWarrant.style.display = 'none';

  }
}

$(document).on("keypress", "form", function(event) {
    return event.keyCode != 13;
});

$('#plateName').on("keyup", function(e) {
    if (e.keyCode == 13) {
        searchPlate()
    }
});

$('#civName').on("keyup", function(e) {
    if (e.keyCode == 13) {
        searchNames()
    }
});

function toggle_visibility(id) {
      if(id.style.display == 'block')
         id.style.display = 'none';
      else
         id.style.display = 'block';
   }

function setDateAndTime() {
  date = document.getElementById('date');
  time = document.getElementById('time');



  date.value = new Date().toLocaleDateString();
  time.value = new Date().toLocaleTimeString('en-GB', { hour: "numeric", minute: "numeric"});
}

$('#ticketModal').on('hidden.bs.modal', function () {
    $(this).find('form').trigger('reset');

})

$('#nameDatabaseModal').on('hidden.bs.modal', function () {
    $(this).find('form').trigger('reset');
    var civ = document.getElementById('civDetails');
    civ.style.display = 'none'
})

$('#plateDatabaseModal').on('hidden.bs.modal', function () {
    $(this).find('form').trigger('reset');
    var plate = document.getElementById('plateDetails');
    plate.style.display = 'none'
})
</script>
